"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const db_1 = require("../db");
const client = require("../config");
class Guilds {
    static async fetch(target, targetName) {
        if (!target)
            console.error("missing target");
        if (!targetName)
            console.error("missing targetName");
        await db_1.pool.query("INSERT INTO guilds (guildID, guildName, prefixes, modulesID) VALUES($1, $2, $3, $1) ON CONFLICT DO NOTHING", [target, targetName, client.prefix]);
        let guildSettings = await db_1.pool.query("SELECT * FROM guilds WHERE guildID = $1;", [target]);
        guildSettings = guildSettings.rows[0];
        if (!targetName == guildSettings.guildName) {
            await db_1.pool.query("INSERT INTO GUILDS (guildsName) VALUES($1) WHERE guildID = $2 ON CONFLICT DO NOTHING", [targetName, targetName]);
            if (!guildSettings)
                return false;
        }
        return guildSettings;
    }
}
exports.default = Guilds;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ3VpbGRzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2NsaWVudC9ndWlsZHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSw4QkFBNkI7QUFDN0IsTUFBTSxNQUFNLEdBQUcsT0FBTyxDQUFDLFdBQVcsQ0FBQyxDQUFDO0FBRXBDLE1BQXFCLE1BQU07SUFDekIsTUFBTSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsTUFBYyxFQUFFLFVBQWtCO1FBQ25ELElBQUksQ0FBQyxNQUFNO1lBQUUsT0FBTyxDQUFDLEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1FBQzdDLElBQUksQ0FBQyxVQUFVO1lBQUUsT0FBTyxDQUFDLEtBQUssQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO1FBRXJELE1BQU0sU0FBSSxDQUFDLEtBQUssQ0FDZCw0R0FBNEcsRUFDNUcsQ0FBQyxNQUFNLEVBQUUsVUFBVSxFQUFFLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FDcEMsQ0FBQztRQUNGLElBQUksYUFBYSxHQUFHLE1BQU0sU0FBSSxDQUFDLEtBQUssQ0FDbEMsMENBQTBDLEVBQzFDLENBQUMsTUFBTSxDQUFDLENBQ1QsQ0FBQztRQUNGLGFBQWEsR0FBRyxhQUFhLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3RDLElBQUksQ0FBQyxVQUFVLElBQUksYUFBYSxDQUFDLFNBQVMsRUFBRTtZQUMxQyxNQUFNLFNBQUksQ0FBQyxLQUFLLENBQ2Qsc0ZBQXNGLEVBQ3RGLENBQUMsVUFBVSxFQUFFLFVBQVUsQ0FBQyxDQUN6QixDQUFDO1lBRUYsSUFBSSxDQUFDLGFBQWE7Z0JBQUUsT0FBTyxLQUFLLENBQUM7U0FDbEM7UUFFRCxPQUFPLGFBQWEsQ0FBQztJQUN2QixDQUFDO0NBQ0Y7QUF6QkQseUJBeUJDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcG9vbCB9IGZyb20gXCIuLi9kYlwiO1xyXG5jb25zdCBjbGllbnQgPSByZXF1aXJlKFwiLi4vY29uZmlnXCIpO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgR3VpbGRzIHtcclxuICBzdGF0aWMgYXN5bmMgZmV0Y2godGFyZ2V0OiBzdHJpbmcsIHRhcmdldE5hbWU6IHN0cmluZykge1xyXG4gICAgaWYgKCF0YXJnZXQpIGNvbnNvbGUuZXJyb3IoXCJtaXNzaW5nIHRhcmdldFwiKTtcclxuICAgIGlmICghdGFyZ2V0TmFtZSkgY29uc29sZS5lcnJvcihcIm1pc3NpbmcgdGFyZ2V0TmFtZVwiKTtcclxuXHJcbiAgICBhd2FpdCBwb29sLnF1ZXJ5KFxyXG4gICAgICBcIklOU0VSVCBJTlRPIGd1aWxkcyAoZ3VpbGRJRCwgZ3VpbGROYW1lLCBwcmVmaXhlcywgbW9kdWxlc0lEKSBWQUxVRVMoJDEsICQyLCAkMywgJDEpIE9OIENPTkZMSUNUIERPIE5PVEhJTkdcIixcclxuICAgICAgW3RhcmdldCwgdGFyZ2V0TmFtZSwgY2xpZW50LnByZWZpeF1cclxuICAgICk7XHJcbiAgICBsZXQgZ3VpbGRTZXR0aW5ncyA9IGF3YWl0IHBvb2wucXVlcnkoXHJcbiAgICAgIFwiU0VMRUNUICogRlJPTSBndWlsZHMgV0hFUkUgZ3VpbGRJRCA9ICQxO1wiLFxyXG4gICAgICBbdGFyZ2V0XVxyXG4gICAgKTtcclxuICAgIGd1aWxkU2V0dGluZ3MgPSBndWlsZFNldHRpbmdzLnJvd3NbMF07XHJcbiAgICBpZiAoIXRhcmdldE5hbWUgPT0gZ3VpbGRTZXR0aW5ncy5ndWlsZE5hbWUpIHtcclxuICAgICAgYXdhaXQgcG9vbC5xdWVyeShcclxuICAgICAgICBcIklOU0VSVCBJTlRPIEdVSUxEUyAoZ3VpbGRzTmFtZSkgVkFMVUVTKCQxKSBXSEVSRSBndWlsZElEID0gJDIgT04gQ09ORkxJQ1QgRE8gTk9USElOR1wiLFxyXG4gICAgICAgIFt0YXJnZXROYW1lLCB0YXJnZXROYW1lXVxyXG4gICAgICApO1xyXG5cclxuICAgICAgaWYgKCFndWlsZFNldHRpbmdzKSByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGd1aWxkU2V0dGluZ3M7XHJcbiAgfVxyXG59XHJcbiJdfQ==